@using Microsoft.AspNetCore.Mvc.TagHelpers
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers

@using SNDTRCK.Models

@model List<Product>
@{
	Layout = "../_Shared/_Layout";
}

<h2>Manage Products</h2>

<table class="table table-hover manage-admin">
	<thead>
		<tr>
			<th scope="col"></th>
			<th scope="col">Title</th>
			<th scope="col">Artist</th>
			<th scope="col">Genre</th>
			<th scope="col">Price</th>
			<th scope="col"></th>
		</tr>
	</thead>
	<tbody>

		@if (Model != null)
		{
			@foreach (var p in Model)
			{
				<tr>
					<th scope="col">
						<img src="~/@p.CoverImageLink" class="product-image" />
					</th>
					<th scope="col">@p.Title</th>
					<th scope="col">@p.Artist</th>
					<th scope="col">@p.Genre</th>
					<th scope="col">@p.Price</th>



					<th scope="col">
						<form class="inline-button" asp-area="Admin" asp-controller="Product" asp-action="EditProduct" method="get">
							<input type="hidden" name="productId" value="@p.ProductId" />
							<button type="submit" class="btn btn-success">Edit</button>
						</form>
						<form asp-area="Admin" asp-controller="Product" asp-action="DeleteProduct" method="post" class="delete-form inline-button">
							<input type="hidden" name="productId" value="@p.ProductId" />

							<button type="button" class="btn btn-danger" onclick="confirmDelete('@p.ProductId')">Delete</button>
						</form>
					</th>
				</tr>


			}
		}

	</tbody>
</table>

<h3>Add New Product</h3>
<form id="add-admin" asp-area="Admin" asp-controller="Product" asp-action="SaveNewProduct" enctype="multipart/form-data">

	<table>
		<tbody>

			<tr>
				<th>
					<label for="title">Title </label>
				</th>
				<th>
					<input type="text" id="title" name="title" placeholder="Album Title..." required />
				</th>
			</tr>

			<tr>
				<th>
					<label for="artist">Artist: </label>
				</th>
				<th>
					<input type="text" id="artist" name="artist" placeholder="Album Artist..." required />
				</th>
			</tr>

			<tr>
				<th>
					<label for="genre">Genre: </label>
				</th>
				<th>
					<select id="genre" name="genre" required>
						<option value="Rock">Rock</option>
						<option value="Classical">Classical</option>
						<option value="Country">Country</option>
						<option value="EDM">EDM</option>
						<option value="Drum & Bass">Drum & Bass</option>
						<option value="Dubstep">Dubstep</option>
						<option value="House">House</option>
						<option value="Pop">Pop</option>
						<option value="R&amp; & Soul">R&B & Soul</option>
						<option value="Soundtrack">Soundtrack</option>
						<option value="Techno">Techno</option>
						<option value="Trap">Trap</option>
						<option value="Hip Hop & Rap">Hip Hop & Rap</option>
						<option value="Indie">Indie</option>
						<option value="Chiptune">Chiptune</option>
						<option value="OST">OST</option>
						<option value="New Age">New Age</option>
					</select>
				</th>
			</tr>
			<tr>
				<th>
					<label for="description">Description: </label>
				</th>
				<th>
					<input type="text" id="description" name="description" placeholder="Album Description..." required />
				</th>
			</tr>

			<tr>
				<th>
					<label for="label">Record Label: </label>
				</th>
				<th>
					<input type="text" id="label" name="label" placeholder="Record Label..." required />
				</th>
			</tr>

			<tr>
				<th>
					<label for="release-year">Release Year: </label>
				</th>
				<th>
					<input type="number" id="release-year" name="release-year" placeholder="Release Year..." required />
				</th>
			</tr>


			<tr>
				<th>
					<label for="price">Price </label>
				</th>
				<th>
					<input type="number" id="price" name="price" placeholder="Price..." required />
				</th>
			</tr>

			<tr>
				<th>
					<label for="album-cover">Upload Cover Image</label>
				</th>
				<th>
					<input type="file" id="image" name="image" class="form-control-file" required>
				</th>
			</tr>
		</tbody>
	</table>

	<button type="submit" id="submit-btn" class="btn btn-primary" name="submit-btn" value="Save Album">Save Album</button>
</form>

<script>
	function confirmDelete(productId) {
		if (confirm("Are you sure you want to delete this product?")) {
			// Find the form associated with the delete button

			var form = document.querySelector('.delete-form input[name="productId"][value="' + productId + '"]').parentNode;
			form.submit();
		}
	}
</script>
